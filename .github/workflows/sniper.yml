name: Hybrid Sniper V7.1 Execution

# 트리거: 매일 아침 6시(한국시간) 또는 수동 실행(workflow_dispatch)
on:
  schedule:
    - cron: '0 21 * * *'  # UTC 21:00 = KST 06:00
  workflow_dispatch:      # 수동 실행 버튼 활성화

permissions:
  contents: write  # [중요] 웹사이트 배포를 위한 권한 부여

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    
    steps:
    # 1. 저장소 코드 가져오기
    - name: Checkout repository
      uses: actions/checkout@v3

    # 2. 파이썬 환경 설정
    - name: Set up Python 3.11
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'

    # 3. 라이브러리 설치
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install yfinance requests deep-translator pandas numpy

    # 4. 스나이퍼 가동 (파이썬 코드 실행)
    - name: Run V7.1 Sniper Logic
      run: |
        python run.py

    # 5. [핵심] GitHub Pages로 결과물 자동 배포 (웹사이트화)
    - name: Deploy to GitHub Pages
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./data/artifacts/dashboard  # HTML이 생성되는 폴더 지정
        force_orphan: true                 # 깔끔하게 덮어쓰기
